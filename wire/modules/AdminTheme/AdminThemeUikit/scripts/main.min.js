var ProcessWireAdminTheme={init:function(){this.setupInputfields();this.setupTooltips();this.checkLayout()},ready:function(){this.setupCloneButton();ProcessWireAdmin.init();this.setupSearch();this.setupSideNav();var b=$("body");$(document).on("wiretabclick opened",function(c){$("body").addClass("pw-fake-resize");$(window).resize();setTimeout(function(){$("body").removeClass("pw-fake-resize")},100)});$("a.notice-remove","#notices").click(function(){$("#notices").slideUp("fast",function(){$(this).remove()});return false});$("a.pw-logo-link").click(this.logoClickEvent);$("#_ProcessPageEditView").click(function(c){c.stopPropagation()});var a=null;$(window).resize(function(){if(a){return}a=setTimeout(function(){ProcessWireAdminTheme.windowResized();a=null},250)});this.setupMasthead();this.setupWireTabs();b.removeClass("pw-init").addClass("pw-ready")},setupWireTabs:function(){var a=$(".WireTabs");if(a.length){$(document).on("wiretabclick",function(b,c){ProcessWireAdminTheme.wireTabClick(c)});setTimeout(function(){var c=a.children(".uk-active");if(c.length){var b=$(c.find("a").attr("href"));if(b.length){ProcessWireAdminTheme.wireTabClick(b)}}},500)}},wireTabClick:function(a){if(!a.length){return}var d=null;var b=null;if(a.hasClass("InputfieldWrapper")){b=a.children(".Inputfields").children(".Inputfield:eq(0)");d=b.children(".InputfieldHeader")}else{if(a.hasClass("Inputfield")){b=a;d=a.children(".InputfieldHeader")}}if(!d||!d.length){return}var i=false;var c=["InputfieldIsPrimary","InputfieldIsWarning","InputfieldIsError","InputfieldIsHighlight","InputfieldIsSuccess"];for(var f=0;f<c.length;f++){if(b.hasClass(c[f])){i=true;break}}if(i){return}var h=$("#_"+a.attr("id")).parent();if(!h.length){return}var g=h.children("a");var e=d.css("background-color");if(h.css("background-color")!=e&&g.css("background-color")!=e){h.addClass("pw-tab-muted")}},checkLayout:function(){if($("body").attr("class").indexOf("pw-layout-sidenav")==-1){return}if($("body").hasClass("pw-layout-sidenav-init")){return}if(typeof parent=="undefined"||typeof parent.isPresent=="undefined"){var a=window.location.href;if(a.indexOf("layout=")>-1){a=a.replace(/([?&]layout)=[-_a-zA-Z0-9]+/,"$1=sidenav-init")}else{a+=(a.indexOf("?")>0?"&":"?")+"layout=sidenav-init"}window.location.href=a}},windowResized:function(){if($("body").hasClass("pw-fake-resize")){return}this.setupMasthead()},setupMasthead:function(){var b=$("#pw-masthead");var e=$("#pw-masthead-mobile");var c=$(window).width();var a=0;var d=0;if(c>767){d=parseInt(b.data("pw-height"));a=b.children(".pw-container").height()}else{a=999}if(b.hasClass("uk-hidden")){b.removeClass("uk-hidden")}if(a>d){if(!b.hasClass("pw-masthead-hidden")){b.addClass("pw-masthead-hidden").css({position:"absolute",top:"-9999px"});e.removeClass("uk-hidden");$("#offcanvas-toggle").removeClass("uk-hidden")}}else{if(b.hasClass("pw-masthead-hidden")){e.addClass("uk-hidden");b.removeClass("pw-masthead-hidden").css({position:"relative",top:0});$("#offcanvas-toggle").addClass("uk-hidden")}}},setupCloneButton:function(){if($("body").is(".modal")){return}var c=$("button.pw-head-button, button.head_button_clone");if(c.length==0){return}var a=$("#pw-content-head-buttons");var e=null;var h=null;var d={};c.each(function(){var m=$(this);var k=m.parent("a");var j;if(k.length>0){j=m.parent("a").clone(true);a.prepend(j)}else{if(m.hasClass("pw-head-button")||m.hasClass("head_button_clone")){j=m.clone(true);j.attr("data-from_id",m.attr("id")).attr("id",m.attr("id")+"_copy").addClass("pw-head-button");j.click(function(){$("#"+$(this).attr("data-from_id")).click();return false});if(j.hasClass("pw-button-dropdown-toggle")){var l=j.attr("id").replace("pw-dropdown-toggle-","");d[l]=j}else{if(j.hasClass("pw-button-dropdown-main")){var i=$("<span></span>").addClass("pw-button-dropdown-wrap");i.append(j).addClass("uk-float-right");a.prepend(i)}else{j.addClass("uk-float-right");a.prepend(j)}}}}});for(var g in d){var b=d[g];var f=$("#"+g);f.after(b)}},setupSearch:function(){$.widget("custom.adminsearchautocomplete",$.ui.autocomplete,{_renderMenu:function(c,a){var d=this;var b="";c.addClass("pw-dropdown-menu-shorter uk-nav uk-nav-default");c.css("z-index",9999);$.each(a,function(e,f){if(f.type!=b){if(b.length){$("<li class='uk-nav-divider'></li>").appendTo(c)}$("<li>"+f.type+"</li>").addClass("uk-nav-header").appendTo(c);b=f.type}d._renderItemData(c,f)})},_renderItem:function(a,b){if(b.label==b.template){b.template=""}return $("<li></li>").append("<a href='"+b.edit_url+"'>"+b.label+" <small class='uk-text-muted'>"+b.template+"</small></a>").appendTo(a)}});$(".pw-search-form").each(function(){var b=$(this);var c=b.find(".pw-search-input");var a={my:"right top",at:"right bottom"};if(b.closest(".uk-offcanvas-bar").length){a.my="left top";a.at="left bottom"}c.click(function(d){d.stopPropagation()});c.adminsearchautocomplete({minLength:2,position:a,search:function(d,e){b.find(".pw-search-icon").addClass("uk-hidden");b.find(".pw-spinner-icon").removeClass("uk-hidden")},open:function(d,e){},close:function(d,e){},source:function(f,d){var e=c.parents("form").attr("data-action")+"for?get=template_label,title&include=all&admin_search="+f.term;$.getJSON(e,function(h){var g=h.matches.length;if(g<h.total){}else{}b.find(".pw-search-icon").removeClass("uk-hidden");b.find(".pw-spinner-icon").addClass("uk-hidden");d($.map(h.matches,function(i){return{label:i.title,value:i.title,page_id:i.id,template:i.template_label?i.template_label:"",edit_url:i.editUrl,type:i.type}}))})},select:function(d,e){$(this).val("");d.preventDefault();if(typeof parent.isPresent=="undefined"){window.location=e.item.edit_url}else{parent.jQuery("#pw-admin-main")[0].contentWindow.document.location.href=e.item.edit_url}}}).focus(function(){}).blur(function(){})})},setupSideNav:function(){$(".pw-sidebar-nav").on("click","a",function(d){var e=$(this);if(!e.hasClass("pw-has-ajax-items")){d.stopPropagation();return}var b=e.closest("li").find("ul");var a=$(this).attr("data-json");if(b.hasClass("navJSON")){return false}var c=$("<li class='pw-nav-spinner'><i class='fa fa-spin fa-spinner'></i></li>");b.append(c);$.getJSON(a,function(g){var i=e.clone();var f=i.find("i");if(!f.length){f=$("<i></i>");i.prepend(f)}f.attr("class","fa fa-fw fa-arrow-circle-right pw-nav-icon");i.removeAttr("data-json").removeAttr("class");i.find("small").remove();var h=$("<li></li>").addClass("pw-nav-dup").append(i);b.append(h);if(g.add){var h=$("<li class='pw-nav-add'><a href='"+g.url+g.add.url+"'><i class='fa fa-fw fa-"+g.add.icon+" pw-nav-icon'></i>"+g.add.label+"</a></li>");b.append(h)}$.each(g.list,function(k){if(this.label.indexOf("<span")>-1){this.label=this.label.replace(/<\/?span[^>]*>/g,"")}var q="";var r=$("<div>"+this.label+"</div>");var s=r.text();if(s.length>30){var o=r.find("small");if(o.length){o.remove()}s=r.text();s=s.substring(0,30);var k=s.lastIndexOf(" ");if(k>3){s=s.substring(0,k)+"â€¦ "}r.html(s);if(o.length){r.append(o)}}s=r.html().replace("&nbsp;"," ");if(this.icon){q="<i class='fa fa-fw fa-"+this.icon+" pw-nav-icon'></i>"}var j=this.url.indexOf("/")===0?this.url:g.url+this.url;var l=$("<a href='"+j+"'>"+q+s+"</a>");var p=$("<li></li>").append(l);if(this.navJSON!="undefined"&&this.navJSON){l.addClass("pw-has-items pw-has-ajax-items").attr("data-json",this.navJSON);var m=$("<ul class='uk-nav-sub uk-nav-parent-icon'></ul>");p.addClass("uk-parent").append(m);UIkit.nav(m,{multiple:true})}if(typeof this.className!="undefined"&&this.className&&this.className.length){p.addClass(this.className)}if(p.hasClass("pw-nav-add")||p.hasClass("pw-pagelist-show-all")){b.children(".pw-nav-dup").after(p.removeClass("separator").addClass("pw-nav-add"))}else{b.append(p)}});c.remove();b.addClass("navJSON").addClass("length"+parseInt(g.list.length)).hide();if(b.children().length){b.css("opacity",1).fadeIn("fast")}});return false})},setupInputfields:function(){function e(){$("form.uk-form-horizontal").each(function(){$(this).find(".InputfieldContent > .Inputfields").each(function(){var h=$(this);h.addClass("uk-form-vertical");h.find(".uk-form-label").removeClass("uk-form-label");h.find(".uk-form-controls").removeClass("uk-form-controls")});$(this).find(".InputfieldSubmit, .InputfieldButton").each(function(){$(this).find(".InputfieldContent").before("<div class='uk-form-label'>&nbsp;</div>")})});$(".InputfieldNoBorder.uk-card").removeClass("uk-card uk-card-default");$(".InputfieldIsOffset.InputfieldColumnWidthFirst").each(function(){var i=$(this);var h;do{h=i.next(".InputfieldColumnWidth");if(!h.length||h.hasClass("InputfieldColumnWidthFirst")){break}h.addClass("InputfieldIsOffset");i=h}while(true)});$(".Inputfields").each(function(){b($(this))});$(".ui-widget.Inputfield, .ui-widget-header.InputfieldHeader, .ui-widget-content.InputfieldContent").removeClass("ui-widget ui-widget-header ui-widget-content");$(".MarkupPagerNav:not(.uk-pagination)").each(function(){$(this).addClass("uk-pagination")})}function b(h){$(".InputfieldRowFirst",h).removeClass("InputfieldRowFirst");$(".InputfieldRowLast",h).removeClass("InputfieldRowLast");var i=h.children(".Inputfield:not(.InputfieldStateHidden):eq(0)");if(!i.length){return}do{i.addClass("InputfieldRowFirst");i=i.next(".Inputfield:not(.InputfieldStateHidden)")}while(i.hasClass("InputfieldColumnWidth")&&!i.hasClass("InputfieldColumnWidthFirst"));i=h.children(".Inputfield:last-child");while(i.length&&i.hasClass("InputfieldStateHidden")){i=i.prev(".Inputfield")}do{i.addClass("InputfieldRowLast");if(!i.hasClass("InputfieldColumnWidth")||i.hasClass("InputfieldColumnWidthFirst")){break}i=i.prev(".Inputfield:not(.InputfieldStateHidden)")}while(i.hasClass("InputfieldColumnWidth"))}function a(j,n){var i="uk-width-1-1";var h=i;var l=false;if(typeof j=="string"&&typeof n!="undefined"){h=j;l=true}else{if(!j||j>=100){h=i}else{for(var k in ProcessWire.config.ukGridWidths){var m=ProcessWire.config.ukGridWidths[k];k=parseInt(k);if(j>=k){h="uk-width-"+m;break}}}}if(!l&&h!=i){h+="@m"}if(typeof n!="undefined"){if(n.hasClass(h)){}else{d(n);n.addClass(h)}}return h}function d(i){var j=null;if(typeof i!="string"){j=i;i=j.attr("class")}if(i.indexOf("uk-width-")>-1){var h=i.replace(/uk-width-(\d-\d@m|\d-\d|expand)\s*/g,"");if(j!==null){j.attr("class",h)}}return i}function g(h){if(!h){return}var o=h.parent().children(".Inputfield");var p=null;var j=0;var n=0;var r=0;var k=0;var i=false;function s(t,v){if(!i){return}if(typeof v=="undefined"){v=h}var u=v.attr("id");u=u.replace("wrap_Inputfield_","");console.log(u+" (combined width="+j+", w="+r+"): "+t)}function m(t){if(typeof t=="undefined"){t=p}if(t){a("InputfieldColumnWidthLast uk-width-expand",t)}}function l(){if(i){s("A: hidden",h)}k+=r;j+=r;if(p&&j>=100){k+=n;if(i){s("Updating last visible Inputfield to width="+k,p)}a(k,p);j=0;k=0;n=0;p=null}else{n+=r}}function q(){if(i){s("Skipping because full-width",h)}if(j<100&&p){m(p)}p=null;n=0;k=0;j=0}o.each(function(){h=$(this);var w=false;var v=false;var u=h.hasClass("InputfieldColumnWidth");var t=!u||h.hasClass("InputfieldColumnWidthFirst");if(t&&p&&j<100){m(p)}r=u?parseInt(h.attr("data-colwidth")):0;if(!r||r>=100){q();return}if(h.hasClass("InputfieldStateHidden")){l();return}if(!j||j>=100){j=0;v=true;w=false;if(i){s("B: starting new row",h)}}else{if(j+r>100){if(p){m(p)}j=0;v=true;if(i){s("C: start new row because width would exceed 100%",h)}}else{if(j+r==100){w=true;if(i){s("D: width is exactly 100%, so this is the last column",h)}}else{if(i){s("E: not first or last column",h)}}}}if(w){h.addClass("InputfieldColumnWidthLast")}else{h.removeClass("InputfieldColumnWidthLast")}if(v){h.addClass("InputfieldColumnWidthFirst");n=0}else{h.removeClass("InputfieldColumnWidthFirst")}if(w){p=null;j=0;k=0;if(n){r+=n}n=0}else{p=h;j+=r;k=r}a(r,h)});if(j<100&&p){m(p)}}var f=null;var c=function(j,i){var h=$(i);if(j.type=="showInputfield"){h.removeClass("uk-hidden")}else{h.show();h.addClass("uk-hidden")}g(h);if(f){return}f=setTimeout(function(){b(h.closest(".Inputfields"));var k=h.find(".Inputfields");if(k.length){k.each(function(){b($(this))})}f=null},100)};$(document).on("reloaded",function(){e()});$(document).on("hideInputfield",c);$(document).on("showInputfield",c);$("body").addClass("InputfieldColumnWidthsInit");e()},setupTooltips:function(){$(".tooltip, .pw-tooltip").each(function(){$(this).removeClass("tooltip pw-tooltip");UIkit.tooltip($(this))})},linkTargetMainMouseoverEvent:function(){var b=$(this);var a=b.attr("href");if(a.length<2){return}if(b.attr("target")){return}if(b.parent("li").hasClass("PageListActionView")){b.attr("target","_top")}else{b.attr("target","main")}},logoClickEvent:function(){if($("body").hasClass("pw-layout-sidenav-init")){if($("#pw-admin-side").length){toggleSidebarPane()}else{UIkit.toggle("#offcanvas-nav").toggle()}}else{if(ProcessWire.config.adminTheme.logoAction==1){UIkit.toggle("#offcanvas-nav").toggle()}else{return true}}return false}};$(document).ready(function(){ProcessWireAdminTheme.ready()});